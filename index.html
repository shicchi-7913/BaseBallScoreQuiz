<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>野球スコアブッククイズ</title>
  <style>
    .toggle-button {
      margin: 5px;
    }
  </style>
</head>

<body>
  <h1>野球スコアブッククイズ</h1>
  <canvas id="scoreCanvas" width="250" height="250"></canvas>
  <br>
  <button class="toggle-button" onclick="toggleText('space1')">スペース1 トグル</button>
  <button class="toggle-button" onclick="toggleText('space2')">スペース2 トグル</button>
  <button class="toggle-button" onclick="toggleText('space3')">スペース3 トグル</button>
  <button class="toggle-button" onclick="toggleText('space4')">スペース4 トグル</button>
  <button class="toggle-button" onclick="toggleText('center')">中央スペース トグル</button>
  <input type="text" id="inputText" placeholder="文字を入力" style="margin-top: 10px;">
  <button class="toggle-button" onclick="toggleText('xLabel')">追加 トグル</button>
  <button class="toggle-button" onclick="saveCanvasImage()">画像保存</button>

  <script>
    const canvas = document.getElementById('scoreCanvas');
    const ctx = canvas.getContext('2d');

    // 各スペースに文字を追加するフラグ（初期状態はすべて非表示）
    const spaceText = {
      space1: false,
      space2: false,
      space3: false,
      space4: false,
      center: false,
      xLabel: false,
      xLabelCount: 0,
      inputTexts: []
    };

    // 各スペースに文字を描画する関数
    function drawText() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // 再描画 - 枠線とサイド部分、十字線、ひし形
      ctx.setLineDash([]); // 点線設定を解除
      ctx.beginPath();
      ctx.rect(20, 20, 190, 160);
      ctx.stroke();

      // 縦線の描画
      ctx.beginPath();
      ctx.moveTo(50, 20);
      ctx.lineTo(50, 180);
      ctx.stroke();

      ctx.setLineDash([3, 3]);
      ctx.beginPath();
      ctx.moveTo(50, 100);
      ctx.lineTo(90, 100);
      ctx.moveTo(170, 100);
      ctx.lineTo(210, 100);
      ctx.moveTo(130, 20);
      ctx.lineTo(130, 60);
      ctx.moveTo(130, 140);
      ctx.lineTo(130, 180);
      ctx.stroke();

      ctx.beginPath();
      ctx.moveTo(130, 60);
      ctx.lineTo(170, 100);
      ctx.lineTo(130, 140);
      ctx.lineTo(90, 100);
      ctx.closePath();
      ctx.stroke();

      ctx.setLineDash([]);
      ctx.font = '12px Arial';
      ctx.fillStyle = 'black';

      if (spaceText.xLabel) {
        for (let i = 0; i < spaceText.xLabelCount; i++) {
          const yOffset = 40 + i * 20;
          const inputText = spaceText.inputTexts[i] || 'X';
          ctx.fillText(inputText, 30, yOffset);
        }
      }

      if (spaceText.space1) ctx.fillText('スペース1', 60, 50);
      if (spaceText.space2) ctx.fillText('スペース2', 150, 50);
      if (spaceText.space3) ctx.fillText('スペース3', 60, 150);
      if (spaceText.space4) ctx.fillText('スペース4', 150, 150);
      if (spaceText.center) ctx.fillText('中央スペース', 100, 105);
    }

    // 初期描画
    drawText();

    // 画像を保存する関数
    function saveCanvasImage() {
      const link = document.createElement('a');
      link.href = canvas.toDataURL('image/png');
      link.download = 'scoreCanvas.png';
      link.click();
    }

    // バツが描かれたクロスキャンバスの描画
    const crossCanvas = document.getElementById('crossCanvas');
    const crossCtx = crossCanvas.getContext('2d');
    crossCtx.beginPath();
    crossCtx.moveTo(30, 30);
    crossCtx.lineTo(40, 40);
    crossCtx.moveTo(40, 30);
    crossCtx.lineTo(30, 40);
    crossCtx.stroke();

    // ボタンが押された時に文字の表示・非表示を切り替える関数
    function toggleText(space) {
      if (space === 'xLabel') {
        spaceText.xLabel = true;
        const inputText = document.getElementById('inputText').value || 'X';
        spaceText.inputTexts.push(inputText);
        spaceText.xLabelCount++;
      } else {
        spaceText[space] = !spaceText[space];
      }
      drawText();
    }

    // リセットボタンが押された時に全ての表示を消す関数
    function resetText() {
      for (let key in spaceText) {
        spaceText[key] = false;
        if (key === 'xLabelCount') {
          spaceText[key] = 0;
        } else if (key === 'inputTexts') {
          spaceText[key] = [];
        }
      }
      drawText();
    }
  </script>
</body>

</html>